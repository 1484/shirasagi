//= require marked
//= require moment
//= require sprintf
//= require fullcalendar
//= require fullcalendar/gcal
//= require fullcalendar/lang/ja
//= require fullcalendar-scheduler/scheduler.min.js
//= require tinyColorPicker/jqColorPicker.min.js
//= require gws/lib/reminder
//= require gws/schedule/lib/calendar
//= require gws/schedule/lib/calendar_basic_hour_view
//= require gws/schedule/lib/multiple_calendar
//= require gws/schedule/lib/plan
//= require gws/schedule/lib/repeat_plan

$ ->
  # external link
  $('a[href^=http]').not('[href*="'+location.hostname+'"]').attr({ target: '_blank' })

  # tabs
  path = location.pathname + "/"
  $(".gws-schedule-tabs a").each ->
    menu = $(this)
    menu.addClass("current") if path.match(new RegExp('^' + menu.attr('href') + '(\/|$)'))

  Gws_Member.render()

class @Gws_Member
  @render: ->
    $('.js-set-from-members').click ->
      dl = $(this).closest('dl')
      dl.find('table').show()

      name = dl.find('.hidden-ids').attr('name')
      tbody = dl.find('tbody')
      target = $(this).data('from')
      target = '.gws-addon-member' unless target

      $("#{target} tbody tr").each ->
        if tbody.find('tr[data-id=' + $(this).data('id') + ']').length == 0
          tr = $(this).clone(true)
          tr.find('input').attr('name', name)
          tbody.append(tr)
      return false
