<%= code_editor ".mod-cms-nodelist .html", mode: :html %>
<%= jquery do %>
  Cms_Editor_CodeMirror.lock('#item_loop_setting_id', '#item_loop_html');

  var changeLoopFormat = function() {
    var format = $("select[name='item[loop_format]']").val();
    console.log(format);
    if (format === "liquid") {
      $(".mod-cms-nodelist.loop-format-shirasagi").addClass("hide");
      $(".mod-cms-nodelist.loop-format-liquid").removeClass("hide");
    } else {
      $(".mod-cms-nodelist.loop-format-shirasagi").removeClass("hide");
      $(".mod-cms-nodelist.loop-format-liquid").addClass("hide");
    }
  };

  changeLoopFormat();

  $("select[name='item[loop_format]']").on("change", changeLoopFormat);
<% end %>

<dl class="see mod-cms-nodelist">
  <dt><%= @model.t :conditions %><%= @model.tt :conditions %></dt>
  <dd><%= f.text_area :conditions, value: @item.conditions.join("\n"), style: "height: 100px;" %></dd>

  <dt><%= @model.t :sort %><%= @model.tt :sort %></dt>
  <dd><%= f.select :sort, @item.sort_options, include_blank: " " %></dd>

  <dt><%= @model.t :limit %><%= @model.tt :limit %></dt>
  <dd><%= f.number_field :limit %></dd>

  <dt><%= @model.t :loop_format %><%= @model.tt :loop_format %></dt>
  <dd><%= f.select :loop_format, @item.loop_format_options %></dd>
</dl>

<dl class="see mod-cms-nodelist loop-format-shirasagi">
  <dt><%= @model.t :upper_html %><%= @model.tt :upper_html %></dt>
  <dd><%= f.text_area :upper_html, class: :html %></dd>

  <dt><%= @model.t :loop_html %><%= @model.tt :loop_html %></dt>
  <dd><%= f.select :loop_setting_id, ancestral_loop_settings, include_blank: t('cms.input_directly') %></dd>
  <dd><%= f.text_area :loop_html, class: :html, style: "height: 100px;" %></dd>

  <dt><%= @model.t :lower_html %><%= @model.tt :lower_html %></dt>
  <dd><%= f.text_area :lower_html, class: :html %></dd>
</dl>

<dl class="see mod-cms-nodelist loop-format-liquid">
  <dt><%= @model.t :loop_liquid %><%= @model.tt :loop_liquid %></dt>
  <dd><%= f.text_area :loop_liquid, class: :html, style: "height: 100px;" %></dd>
</dl>
